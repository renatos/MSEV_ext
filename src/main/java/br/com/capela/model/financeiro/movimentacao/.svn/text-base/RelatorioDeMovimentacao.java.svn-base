package br.com.capela.model.financeiro.movimentacao;

import java.util.Date;
import java.util.List;

import org.joda.time.LocalDate;

import com.google.common.collect.Multimap;

public class RelatorioDeMovimentacao {
	
	private AnaliseDaMovimentacaoFinanceira movimentacaoFinanceiraService;
	
	private List<Movimento> movimentacao;
	private List<TotalizacaoPorConta> totalizacaoPorContas;
	private Multimap<Conta, Movimento> movimentacaoPorConta;
	private Multimap<Conta, Movimento> movimentacaoPorContaEProduto;
	
	public RelatorioDeMovimentacao(AnaliseDaMovimentacaoFinanceira movimentacaoFinanceiraService) {
		this.movimentacaoFinanceiraService = movimentacaoFinanceiraService;
	}
	
	public void consulta(Date dataInicial, Date dataFinal) {
		movimentacao = movimentacaoFinanceiraService
				.obterMovimentacaoNoPeriodo(LocalDate.fromDateFields(dataInicial), LocalDate.fromDateFields(dataFinal));
		movimentacaoPorConta = movimentacaoFinanceiraService.agruparMovimentacaoPorConta(movimentacao);
		totalizacaoPorContas = movimentacaoFinanceiraService.calculaTotalizacao(movimentacaoPorConta);
		movimentacaoPorContaEProduto = movimentacaoFinanceiraService.agruparMovimentacaoPorDescricao(movimentacaoPorConta);
	}
	
	public List<Movimento> getMovimentacao() {
		return movimentacao;
	}
	
	public Multimap<Conta, Movimento> getMovimentacaoPorConta() {
		return movimentacaoPorConta;
	}
	
	public Multimap<Conta, Movimento> getMovimentacaoPorContaEProduto() {
		return movimentacaoPorContaEProduto;
	}
	
	public List<TotalizacaoPorConta> getTotalizacaoPorContas() {
		return totalizacaoPorContas;
	}
}
